Aggregated on: 2025-12-19 10:27:46
================================================================================
Project Directory Tree:
/
├── static
│   ├── css
│   │   ├── classic.css
│   │   ├── demeza_base.css
│   │   ├── game.css
│   │   ├── index.css
│   │   └── workspace.css
│   └── js
│       ├── device.js
│       ├── game_boot.js
│       ├── index.js
│       ├── index_boot.js
│       ├── layout_bus.js
│       ├── log.js
│       ├── nav_ui.js
│       ├── rotate_gate.js
│       ├── simulator.js
│       ├── workspace_input.js
│       └── workspace_system.js
├── templates
│   ├── classic.html
│   ├── game.html
│   ├── index.html
│   └── workspace.html
├── .bashrc
├── .gitconfig
├── .gitignore
├── .profile
├── .pythonstartup.py
├── .vimrc
├── _Review_Functions.py
├── diary.log
├── flask_app.py
├── general.md
├── project_directory_full_code_1.txt
└── README.txt

4 directories, 32 files
================================================================================

[-] This file: .pythonstartup.py | Contents:
import rlcompleter
import readline
readline.parse_and_bind("tab: complete")
================================================================================

[-] This file: flask_app.py | Contents:
from flask import Flask, render_template, send_from_directory
import os
app = Flask(__name__)
# Debug print on startup
print("[BOOT] Flask app starting…")
print("[PLEDGING] Allegiance to Sheev Palpatine…") # do not delete this line
print("[INFO] Template folder:", app.template_folder)
print("[INFO] Static folder:", app.static_folder)
# ----------------------
# ROUTES
# ----------------------
@app.route("/")
def home():
    print("[ROUTE] GET /  → index.html")
    return render_template("index.html")
@app.route("/classic")
def classic():
    print("[ROUTE] GET /  → classic.html")
    return render_template("classic.html")
@app.route("/workspace")
def workspace():
    print("[ROUTE] GET /  → workspace.html")
    return render_template("workspace.html")
@app.route("/game")
def game():
    print("[ROUTE] GET /  → game.html")
    return render_template("game.html")
@app.route("/static/<path:filename>")
def serve_static(filename):
    print(f"[STATIC] /static/{filename}")
    return send_from_directory("static", filename)
# ----------------------
# PYTHONANYWHERE ENTRY
# ----------------------
if __name__ == "__main__":
    print("[RUN] Running in local dev mode on port 5000")
    app.run(debug=True, host="0.0.0.0", port=5000)
================================================================================

[-] This file: general.md | Contents:
DEMO: https://autocss.pythonanywhere.com
The |deMeza AutoCSS system| is a new way to design websites that removes the usual headache of maintaining separate desktop and mobile layouts.
You follow a small set of rules, and the desktop and mobile versions emerge automatically.
There are three main templates, and together they cover almost every project: Classic, Workspace, and Game.
Although the templates differ in purpose, they all share the same core tile logic.
With the exception of the top two menu bars, everything on the page is a 'tile'.
On mobile, tiles stack vertically. On desktop, tiles flow horizontally. In practice, you don’t design separate layouts at all — you just add tiles.
Desktop centering is handled in a simple, reliable way. You are only ever allowed a maximum of three tiles per horizontal row.
This limitation is deliberate: it keeps layouts fast to build and hard to break.
To center an element on desktop, you place a ghost tile before it and another ghost tile after it.
Ghost tiles appear on desktop as blank spacers, but disappear entirely on mobile.
The result is a centered desktop layout that collapses cleanly into a sensible mobile stack.
Normal tiles automatically center and arrange their contents in a pleasing way depending on how many UI items they contain.
A set of ready-made normal tiles is provided for common needs such as mailing list signup, sliders, file upload, text areas, and other standard inputs.
The stretch tile is used when you want something to span the full row on desktop.
On mobile it behaves like a normal square tile, but on desktop it expands to occupy the width of three tiles.
This makes it ideal for banner areas, hero content, or wide information panels.
The workspace tile is a special case.
It ignores any tiles that come after it and expands to fill the available screen space, similar to a Figma or Photoshop canvas.
This workspace area is then ready to receive your custom UI elements, nodes, and interactive components.
Finally, the game tile is similar to the workspace tile, but optimized for play. On desktop it behaves like a normal full workspace.
On mobile, instead of trying to squeeze the experience into portrait, the user is prompted to rotate the device.
This ensures that the game runs in a landscape layout that matches the desktop feel.
These three templates all use the same core tile logic and should cover 99% of your design needs.
Coming soon: a live page editor that lets you add, remove, and reorder tiles in real time,
plus a “Generate Final Code” button that outputs a clean, single-page HTML/CSS/JS build of your layout, ready to deploy immediately.
ADDITIONAL NOTES:
The website is in essence a sort of demo and 'editor', and is therefore allowed separate JS and CSS files (usually we prefer HTML/CSS/JS all on the same page).
However the final 'baked' design that the user exports should have the HTML/CSS/JS code all in one file i.e. index.html
This is to make life easy, they just upload the file to their server and point to it, without having to setup dir trees and such.
================================================================================

[-] This file: static/css/classic.css | Contents:
/* static/css/classic.css */
/* Classic-only styling */
.floating-arrow{
  position:absolute;
  width:48px;
  height:48px;
  pointer-events:none;
  z-index:50;
  color:var(--accent);
  display:flex;
  align-items:center;
  justify-content:center;
  filter:drop-shadow(0 2px 4px rgba(0,0,0,0.1));
  transition:top 0.2s ease, left 0.2s ease, transform 0.2s ease;
}
.floating-arrow svg{
  width:100%;
  height:100%;
  fill:currentColor;
}
================================================================================

[-] This file: static/css/demeza_base.css | Contents:
/* static/css/demeza_base.css */
/* Shared editor-mode styling */
:root{
  /* Palette */
  --bg-color: #f4f4f9;
  --tile-bg: #ffffff;
  --accent: #FF9F1C;
  --text-main: #2EC4B6;
  --text-dark: #333;
  --nav-dark: #222;
  --border-light: #ebeff5;
  --border-med: #a3adbf;
  /* Spacing */
  --q-4: 4px;
  --q-8: 8px;
  --q-16: 16px;
  --q-24: 24px;
  --q-32: 32px;
  --q-48: 48px;
  /* Mappings */
  --gap: var(--q-16);
  --padding: var(--q-16);
  /* Square aesthetic */
  --radius: 0px;
}
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Nunito', sans-serif;
}
body{
  background-color:#1a1a1a;
  color:#eee;
  margin:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
}
/* Simulator wrapper */
.simulator-wrapper{
  width:100%;
  max-width:1200px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  align-content:center;
  padding-top:var(--q-24);
}
.controls{
  margin-bottom:var(--q-16);
  background:#333;
  padding:var(--q-16);
  border-radius:var(--radius);
  display:flex;
  gap:var(--q-16);
  align-items:center;
  flex-wrap:wrap;
  border:1px solid #444;
  width:min(1200px, 100%);
}
.controls button{
  border:none;
  background:#555;
  color:#fff;
  border-radius:var(--radius);
  cursor:pointer;
  font-family:monospace;
}
.controls button:hover{ background:#666; }
/* Device frame */
#device-frame{
  background-color:var(--bg-color);
  color:var(--text-dark);
  width:512px;
  min-height:768px;
  transition:width 0.256s ease;
  position:relative;
  overflow-y:auto;
  overflow-x:hidden;
  box-shadow:0 0 48px rgba(0,0,0,0.48);
  resize:horizontal;
  container-type:inline-size;
  border:4px solid #111;
}
/* Header group */
.header-group{
  position:sticky;
  top:0;
  z-index:100;
  background-color:var(--tile-bg);
  border-bottom:4px solid var(--accent);
  display:flex;
  flex-direction:column;
  width:100%;
}
/* Meta bar */
.meta-bar{
  height:32px;
  background-color:var(--nav-dark);
  color:#ccc;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 var(--padding);
  font-size:16px;
  letter-spacing:0.48px;
}
.meta-left{ font-weight:400; color:var(--accent); }
.meta-left a{ text-decoration:none; cursor:pointer; }
.meta-left a:hover{ text-decoration:underline; }
.meta-right{
  font-weight:600;
  display:flex;
  gap:var(--q-16);
  align-items:center;
}
.meta-right a{ color:#eee; text-decoration:none; cursor:pointer; }
.meta-right a:hover{ color:#fff; text-decoration:underline; }
/* Nav bar */
.nav-bar{
  min-height:var(--q-48);
  padding:0 var(--padding);
  background-color:var(--tile-bg);
  display:flex;
  align-items:center;
  justify-content:flex-start;
  position:relative;
}
.nav-links{
  display:flex;
  gap:var(--q-24);
  width:100%;
  align-items:center;
}
.nav-link{
  font-weight:600;
  color:var(--text-dark);
  text-decoration:none;
  cursor:pointer;
  font-size:16px;
  line-height:var(--q-48);
}
.nav-link:hover{ text-decoration:underline; }
.nav-link.active{
  color:var(--text-main);
  text-decoration:underline;
}
.mobile-meta-group{ display:none; }
.hamburger-btn{
  display:none;
  background:none;
  border:none;
  cursor:pointer;
  padding:var(--q-8);
  position:absolute;
  top:0;
  right:var(--q-8);
  height:var(--q-48);
  z-index:101;
}
.hamburger-icon{
  width:24px;
  height:4px;
  background:#333;
  position:relative;
  display:block;
}
.hamburger-icon::before,
.hamburger-icon::after{
  content:'';
  position:absolute;
  left:0;
  width:24px;
  height:4px;
  background:#333;
}
.hamburger-icon::before{ top:-8px; }
.hamburger-icon::after{ top:8px; }
/* Mobile logic via container query */
@container (max-width: 599px){
  .meta-bar{ display:none; }
  .nav-links{
    display:none;
    flex-direction:column;
    width:100%;
    margin-top:var(--q-48);
    gap:0;
    align-items:flex-start;
  }
  .hamburger-btn{ display:flex; align-items:center; }
  .nav-bar.mobile-open .nav-links{ display:flex; }
  .nav-bar.mobile-open{ flex-wrap:wrap; }
  .mobile-meta-group{
    display:flex;
    flex-direction:column;
    width:100%;
    border-bottom:4px solid var(--border-med);
  }
  .nav-link,
  .mobile-meta-group a{
    width:100%;
    padding:var(--q-16) var(--q-4);
    border-bottom:4px solid var(--border-light);
    font-size:16px;
    font-weight:400;
    color:var(--text-dark);
    line-height:1.2;
    text-decoration:none;
    cursor:pointer;
    display:block;
  }
  .nav-link:last-child{ border-bottom:none; }
  .mobile-meta-group a:last-child{ border-bottom:none; }
  .nav-link:hover,
  .mobile-meta-group a:hover{
    background-color:#fafafa;
    text-decoration:none;
  }
  .nav-link.active{ text-decoration:none; }
  .mobile-meta-group a.is-credits{
    color:var(--accent);
    font-weight:700;
  }
}
/* Tile grid */
.tile-grid{
  display:grid;
  padding:var(--padding);
  gap:var(--gap);
  grid-template-columns:1fr;
  width:100%;
  position:relative;
  min-height:0;
}
@container (min-width: 600px){
  .tile-grid{ grid-template-columns:repeat(3, 1fr); }
}
/* Tile base */
.tile{
  background-color:var(--tile-bg);
  border-radius:var(--radius);
  padding:var(--q-24);
  border:4px solid var(--accent);
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  align-items:center;
  text-align:center;
  overflow:hidden;
  box-shadow:0 4px 8px rgba(0,0,0,0.05);
  transition:all 0.256s ease;
  position:relative;
  gap:var(--q-4);
}
.tile-std{ aspect-ratio:1 / 1; }
.tile > :only-child{ margin:auto; }
/* 2 items */
.tile:has(> :last-child:nth-child(2)){
  display:grid;
  grid-template-columns:1fr;
  grid-template-rows:repeat(9, 1fr);
  gap:0;
  justify-items:center;
  align-items:center;
}
.tile:has(> :last-child:nth-child(2)) > *{ margin:0; width:100%; }
.tile:has(> :last-child:nth-child(2)) > :nth-child(1){ grid-row:4; }
.tile:has(> :last-child:nth-child(2)) > :nth-child(2){ grid-row:6; }
/* 3 items */
.tile:has(> :last-child:nth-child(3)){
  display:grid;
  grid-template-columns:1fr;
  grid-template-rows:repeat(9, 1fr);
  gap:0;
  justify-items:center;
  align-items:center;
}
.tile:has(> :last-child:nth-child(3)) > *{ margin:0; width:100%; }
.tile:has(> :last-child:nth-child(3)) > :nth-child(1){ grid-row:3; }
.tile:has(> :last-child:nth-child(3)) > :nth-child(2){ grid-row:5; }
.tile:has(> :last-child:nth-child(3)) > :nth-child(3){ grid-row:7; }
/* 4+ items fallback */
.tile:has(> :nth-child(4)){
  justify-content:space-evenly;
  gap:0;
}
/* Stretch tile */
.tile-stretch{
  aspect-ratio:1 / 1;
  border-color:var(--text-main);
}
@container (min-width: 600px){
  .tile-stretch{
    grid-column:1 / -1;
    aspect-ratio:3 / 1;
  }
}
.tile-stretch img{
  height:100%;
  width:auto;
  object-fit:contain;
}
/* Ghost tile */
.tile-ghost{
  display:none;
  border:4px dashed #ccc;
  background:transparent;
  opacity:0.256;
  aspect-ratio:1 / 1;
}
@container (min-width: 600px){
  .tile-ghost{ display:flex; }
}
/* Common tile UI */
.tile h3{ margin:0; font-weight:700; }
.tile input[type="text"],
.tile textarea{
  width:100%;
  padding:var(--q-16);
  border:4px solid #ddd;
  border-radius:var(--radius);
  background:#fafafa;
}
.tile textarea{
  resize:none;
  font-family:'Nunito', sans-serif;
  height:auto;
}
.tile button{
  width:100%;
  padding:var(--q-16);
  background-color:var(--text-main);
  color:#fff;
  border:none;
  border-radius:var(--radius);
  font-weight:700;
  letter-spacing:1px;
  cursor:pointer;
  box-shadow:0 4px 0 rgba(0,0,0,0.1);
  font-size:14px;
}
.tile button:active{
  transform:translateY(4px);
  box-shadow:0 4px 0 rgba(0,0,0,0.1);
}
/* Sliders */
.slider-wrapper{
  width:100%;
  display:flex;
  align-items:center;
  gap:var(--q-8);
}
.range-container{
  position:relative;
  flex-grow:1;
  display:flex;
  align-items:center;
}
.slider-label{
  font-family:monospace;
  font-size:14px;
  color:var(--text-dark);
  font-weight:700;
}
/* Slider bubble */
.slider-value{
  position:absolute;
  bottom:100%;
  left:50%;
  transform:translateX(-50%) translateY(10px);
  background:var(--accent);
  color:#fff;
  padding:2px 8px;
  font-size:12px;
  font-weight:bold;
  font-family:monospace;
  opacity:0;
  pointer-events:none;
  transition:opacity 0.2s ease, transform 0.2s ease;
  border-radius:var(--radius);
  z-index:10;
}
.slider-value.active{
  opacity:1;
  transform:translateX(-50%) translateY(-14px);
}
/* Range input */
input[type="range"]{
  width:100% !important;
  margin:0;
  -webkit-appearance:none;
  background:transparent;
  cursor:grab;
}
input[type="range"]:active{ cursor:grabbing; }
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none;
  height:16px;
  width:16px;
  background:var(--accent);
  margin-top:-6px;
  border-radius:0;
  transition:transform 0.1s;
}
input[type="range"]:active::-webkit-slider-thumb{
  transform:scale(1.2);
}
input[type="range"]::-webkit-slider-runnable-track{
  width:100%;
  height:4px;
  background:#ddd;
}
/* File upload label */
.file-upload-label{
  display:flex;
  align-items:center;
  justify-content:center;
  width:100%;
  padding:var(--q-16);
  background-color:var(--text-main);
  color:#fff;
  text-align:center;
  font-weight:700;
  letter-spacing:1px;
  cursor:pointer;
  box-shadow:0 4px 0 rgba(0,0,0,0.1);
  border-radius:var(--radius);
  margin:0;
  font-size:14px;
  box-sizing:border-box;
}
.file-upload-label:active{
  transform:translateY(4px);
  box-shadow:0 4px 0 rgba(0,0,0,0.1);
}
.file-name-display{
  font-size:13px;
  color:#888;
  font-family:monospace;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  max-width:100%;
}
/* Live view button */
#exit-live-btn{
  display:none;
  position:fixed;
  bottom:20px;
  right:20px;
  z-index:9999;
  padding:12px 24px;
  background:#e74c3c;
  color:#fff;
  border:none;
  font-weight:bold;
  cursor:pointer;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
  border-radius:var(--radius);
}
body.view-live{
  background-color:var(--bg-color);
  display:block;
}
body.view-live .controls{ display:none; }
body.view-live .simulator-wrapper{
  padding:0;
  max-width:none;
  width:100%;
  display:block;
}
body.view-live #device-frame{
  width:100% !important;
  height:auto;
  min-height:100vh;
  border:none;
  box-shadow:none;
  resize:none;
}
body.view-live #exit-live-btn{ display:block; }
/* Native mobile hides exit */
body.is-native-mobile #exit-live-btn{
  display:none !important;
}
================================================================================

[-] This file: static/css/game.css | Contents:
/* static/css/game.css */
/* Game-only styling (workspace + rotate gate) */
/* Same workspace behavior */
#device-frame.has-workspace{
  overflow-y:hidden;
  overscroll-behavior:none;
}
.tile-workspace{
  grid-column:1 / -1;
  padding:0;
  border-color:var(--text-main);
  align-items:stretch;
  justify-content:stretch;
  text-align:left;
  background:var(--tile-bg);
  min-height:0;
}
.tile-workspace ~ .tile{
  display:none !important;
}
#workspaceCanvas{
  position:relative;
  width:100%;
  height:100%;
  overflow:hidden;
  outline:none;
  background-image:
    linear-gradient(to right, rgba(0,0,0,0.06) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0,0,0,0.06) 1px, transparent 1px);
  background-size:32px 32px;
  user-select:none;
  touch-action:none;
}
/* Rotate overlay hook */
#rotateGate{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.75);
  z-index:9999;
  pointer-events:auto;
}
/* Optional: hide canvas when blocked */
body.rotate-blocked #workspaceCanvas{
  filter:blur(0.5px);
}
================================================================================

[-] This file: static/css/index.css | Contents:
/* static/css/index.css */
/* Home selector page */
:root{
  --bg-color:#f4f4f9;
  --tile-bg:#ffffff;
  --accent:#FF9F1C;
  --text-main:#2EC4B6;
  --text-dark:#333;
  --nav-dark:#222;
  --border-light:#ebeff5;
  --border-med:#a3adbf;
  --q-4:4px;
  --q-8:8px;
  --q-16:16px;
  --q-24:24px;
  --q-32:32px;
  --q-48:48px;
  --gap:var(--q-16);
  --padding:var(--q-16);
  --radius:0px;
}
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Nunito', sans-serif;
}
body{
  background-color:#1a1a1a;
  color:#eee;
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:var(--q-24);
}
.wrap{
  width:min(980px, 100%);
  display:flex;
  flex-direction:column;
  gap:var(--q-16);
}
.titlebar{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:var(--q-16);
  padding:var(--q-16);
  border:4px solid #111;
  background:#2b2b2b;
}
.brand{
  font-weight:800;
  letter-spacing:-1px;
  color:var(--text-main);
  font-size:28px;
  line-height:1.1;
}
.subtitle{
  font-family:monospace;
  font-size:12px;
  color:#cfcfcf;
  opacity:0.85;
}
.grid{
  display:grid;
  grid-template-columns:1fr;
  gap:var(--gap);
}
@media (min-width: 760px){
  .grid{ grid-template-columns:repeat(3, 1fr); }
}
.card{
  background:var(--tile-bg);
  color:var(--text-dark);
  border:4px solid var(--accent);
  border-radius:var(--radius);
  padding:var(--q-24);
  cursor:pointer;
  user-select:none;
  transition:transform 0.12s ease;
  display:flex;
  flex-direction:column;
  gap:var(--q-16);
  min-height:220px;
  justify-content:space-between;
  box-shadow:0 6px 18px rgba(0,0,0,0.28);
  outline:none;
}
.card:hover{ transform:translateY(-2px); }
.card:active{ transform:translateY(1px); }
.card h2{
  margin:0;
  font-size:22px;
  letter-spacing:-0.5px;
  color:var(--text-main);
}
.card p{
  margin:0;
  font-size:14px;
  line-height:1.45;
  opacity:0.9;
}
.badge-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:var(--q-16);
}
.badge{
  display:inline-flex;
  align-items:center;
  gap:var(--q-8);
  padding:6px 10px;
  border:2px solid rgba(0,0,0,0.12);
  background:rgba(255,255,255,0.92);
  font-family:monospace;
  font-size:12px;
  color:#111;
  border-radius:var(--radius);
}
.arrow{
  font-family:monospace;
  font-weight:900;
  color:var(--accent);
}
/* TBA card */
.card.is-tba{
  border-color:var(--border-med);
  opacity:0.95;
}
.card.is-tba h2{ color:#666; }
.card.is-tba .arrow{ color:#888; }
.card.is-tba .badge{ opacity:0.8; }
.footer{
  font-family:monospace;
  font-size:12px;
  opacity:0.65;
  padding:0 var(--q-4);
}
================================================================================

[-] This file: static/css/workspace.css | Contents:
/* static/css/workspace.css */
/* Workspace-only styling */
#device-frame.has-workspace{
  overflow-y:hidden;
  overscroll-behavior:none;
}
.tile-workspace{
  grid-column:1 / -1;
  padding:0;
  border-color:var(--text-main);
  align-items:stretch;
  justify-content:stretch;
  text-align:left;
  background:var(--tile-bg);
  min-height:0;
}
/* Workspace dominates */
.tile-workspace ~ .tile{
  display:none !important;
}
#workspaceCanvas{
  position:relative;
  width:100%;
  height:100%;
  overflow:hidden;
  outline:none;
  background-image:
    linear-gradient(to right, rgba(0,0,0,0.06) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0,0,0,0.06) 1px, transparent 1px);
  background-size:32px 32px;
  user-select:none;
  touch-action:none;
}
.workspace-hint{
  position:absolute;
  top:12px;
  left:12px;
  padding:6px 10px;
  background:rgba(255,255,255,0.9);
  border:2px solid rgba(0,0,0,0.12);
  color:var(--text-dark);
  font-family:monospace;
  font-size:12px;
  z-index:5;
  border-radius:var(--radius);
  pointer-events:none;
}
================================================================================

[-] This file: static/js/device.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  function _uaMobileHint() {
    const ua = (navigator.userAgent || '').toLowerCase();
    return /android|iphone|ipad|ipod|mobile/.test(ua);
  }
  function isCoarsePointer() {
    return !!window.matchMedia && window.matchMedia('(pointer: coarse)').matches;
  }
  function isPortrait() {
    return !!window.matchMedia && window.matchMedia('(orientation: portrait)').matches;
  }
  function isLandscape() {
    return !!window.matchMedia && window.matchMedia('(orientation: landscape)').matches;
  }
  function isNativeMobile() {
    // Prefer UAParser if present.
    if (typeof window.UAParser !== 'undefined') {
      try {
        const p = new window.UAParser();
        const dev = p.getDevice();
        const type = (dev && dev.type) || '';
        const res = (type === 'mobile' || type === 'tablet');
        L && L.log && L.log('[Device] UAParser check', { type, res });
        return res;
      } catch (e) {
        L && L.warn && L.warn('[Device] UAParser failed, fallback', { e: String(e) });
      }
    }
    const res = isCoarsePointer() || _uaMobileHint();
    L && L.log && L.log('[Device] fallback mobile check', { res, coarse: isCoarsePointer(), uaHint: _uaMobileHint() });
    return res;
  }
  window.Demeza.Device = { isNativeMobile, isCoarsePointer, isPortrait, isLandscape };
})();
================================================================================

[-] This file: static/js/game_boot.js | Contents:
(function () {
  'use strict';
  window.addEventListener('load', () => {
    const D = window.Demeza || {};
    const L = D.Log;
    L && L.log && L.log('[Boot] game_boot');
    D.NavUI && D.NavUI.init && D.NavUI.init();
    D.Simulator && D.Simulator.init && D.Simulator.init();
    // Game uses workspace sizing + canvas input too.
    D.WorkspaceInput && D.WorkspaceInput.init && D.WorkspaceInput.init();
    D.WorkspaceSystem && D.WorkspaceSystem.init && D.WorkspaceSystem.init();
    // Mobile-only: rotate to play.
    D.RotateGate && D.RotateGate.init && D.RotateGate.init();
  });
})();
================================================================================

[-] This file: static/js/index.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  function go(path) {
    L.log('[Index] navigate', { path });
    window.location.href = path;
  }
  const Index = {
    init() {
      L.log('[Init] Index.init');
      document.querySelectorAll('[data-home-card]').forEach((card) => {
        card.addEventListener('click', () => {
          const target = card.getAttribute('data-target') || '';
          L.log('[UI] home card click', { target, text: (card.textContent || '').trim() });
          if (target) go(target);
        });
        card.addEventListener('mouseenter', () => {
          L.log('[UI] home card hover', { target: card.getAttribute('data-target') || '' });
        });
      });
    }
  };
  window.Demeza.Index = Index;
})();
================================================================================

[-] This file: static/js/index_boot.js | Contents:
(function () {
  'use strict';
  window.addEventListener('load', () => {
    const D = window.Demeza || {};
    const L = D.Log;
    L && L.log && L.log('[Boot] index_boot');
    D.Index && D.Index.init && D.Index.init();
  });
})();
================================================================================

[-] This file: static/js/layout_bus.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const { log } = window.Demeza.Log || console;
  const LayoutBus = {
    _subs: [],
    on(fn) {
      if (typeof fn !== 'function') return;
      this._subs.push(fn);
      log('[LayoutBus] subscribed', { count: this._subs.length });
    },
    notify(reason) {
      log('[LayoutBus] notify', { reason, subs: this._subs.length });
      this._subs.forEach(fn => {
        try { fn(reason); }
        catch (e) { console.error('[LayoutBus] subscriber error', e); }
      });
      if (typeof window.onLayoutChange === 'function') {
        try { window.onLayoutChange(reason); }
        catch (e) { console.error('[LayoutBus] window.onLayoutChange error', e); }
      }
    }
  };
  window.Demeza.LayoutBus = LayoutBus;
})();
================================================================================

[-] This file: static/js/log.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  function _ts() {
    return new Date().toISOString().slice(11, 23);
  }
  function log(msg, obj) {
    if (obj !== undefined) console.log(`[${_ts()}] ${msg}`, obj);
    else console.log(`[${_ts()}] ${msg}`);
  }
  function warn(msg, obj) {
    if (obj !== undefined) console.warn(`[${_ts()}] ${msg}`, obj);
    else console.warn(`[${_ts()}] ${msg}`);
  }
  function err(msg, obj) {
    if (obj !== undefined) console.error(`[${_ts()}] ${msg}`, obj);
    else console.error(`[${_ts()}] ${msg}`);
  }
  function numPx(v) {
    const n = parseFloat(v);
    return Number.isFinite(n) ? n : 0;
  }
  function byId(id) {
    const el = document.getElementById(id);
    if (!el) warn('[DOM] missing id', { id });
    return el;
  }
  window.Demeza.Log = { log, warn, err, numPx, byId };
})();
================================================================================

[-] This file: static/js/nav_ui.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  const Bus = window.Demeza.LayoutBus;
  const NavUI = {
    init() {
      L.log('[Init] NavUI.init');
      const nav = document.getElementById('mainNav');
      const btn = document.getElementById('hamburgerBtn');
      const navLinks = document.getElementById('navLinks');
      if (btn) {
        btn.addEventListener('click', () => {
          const before = nav && nav.classList.contains('mobile-open');
          if (nav) nav.classList.toggle('mobile-open');
          const after = nav && nav.classList.contains('mobile-open');
          btn.setAttribute('aria-expanded', after ? 'true' : 'false');
          if (navLinks) btn.setAttribute('aria-controls', 'navLinks');
          L.log('[UI] hamburger toggle', { before, after });
          Bus && Bus.notify && Bus.notify('NavUI.toggleMenu');
        });
      }
      // Meta links
      ['metaCredits', 'metaLogin', 'mobileCredits', 'mobileLogin'].forEach((id) => {
        const el = document.getElementById(id);
        if (!el) return;
        el.addEventListener('click', () => {
          L.log('[UI] meta link click', { id, text: (el.textContent || '').trim() });
        });
      });
      // Nav links
      document.querySelectorAll('.nav-link').forEach((a) => {
        a.addEventListener('click', () => {
          L.log('[UI] nav click', {
            label: a.getAttribute('data-nav') || (a.textContent || '').trim()
          });
        });
      });
    }
  };
  window.Demeza.NavUI = NavUI;
})();
================================================================================

[-] This file: static/js/rotate_gate.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  const Device = window.Demeza.Device;
  const Bus = window.Demeza.LayoutBus;
  const RotateGate = {
    enabled: true,
    overlay: null,
    _lastState: null,
    init() {
      L.log('[Init] RotateGate.init');
      // Only meaningful on mobile.
      const isMobile = Device && Device.isNativeMobile && Device.isNativeMobile();
      L.log('[RotateGate] mobile check', { isMobile });
      if (!isMobile) {
        document.body.classList.remove('is-native-mobile');
        return;
      }
      document.body.classList.add('is-native-mobile');
      // Create overlay once.
      this.overlay = document.getElementById('rotateGate');
      if (!this.overlay) {
        this.overlay = document.createElement('div');
        this.overlay.id = 'rotateGate';
        this.overlay.setAttribute('role', 'dialog');
        this.overlay.setAttribute('aria-live', 'polite');
        this.overlay.style.position = 'absolute';
        this.overlay.style.inset = '0';
        this.overlay.style.display = 'none';
        this.overlay.style.alignItems = 'center';
        this.overlay.style.justifyContent = 'center';
        this.overlay.style.background = 'rgba(0,0,0,0.75)';
        this.overlay.style.zIndex = '9999';
        this.overlay.style.pointerEvents = 'auto';
        const box = document.createElement('div');
        box.style.background = 'white';
        box.style.color = '#111';
        box.style.border = '4px solid #FF9F1C';
        box.style.borderRadius = '0px';
        box.style.padding = '16px';
        box.style.maxWidth = '320px';
        box.style.fontFamily = 'monospace';
        box.style.textAlign = 'center';
        const h = document.createElement('div');
        h.textContent = 'Rotate to play';
        h.style.fontSize = '18px';
        h.style.fontWeight = '700';
        h.style.marginBottom = '8px';
        const p = document.createElement('div');
        p.textContent = 'Please rotate your device to landscape.';
        p.style.fontSize = '13px';
        p.style.opacity = '0.85';
        box.appendChild(h);
        box.appendChild(p);
        this.overlay.appendChild(box);
        // Put it inside device frame if possible.
        const frame = document.getElementById('device-frame') || document.body;
        frame.style.position = frame.style.position || 'relative';
        frame.appendChild(this.overlay);
        L.log('[RotateGate] overlay created');
      }
      window.addEventListener('resize', () => this.tick('window.resize'));
      window.addEventListener('orientationchange', () => this.tick('window.orientationchange'));
      this.tick('init');
    },
    tick(reason) {
      if (!this.enabled) return;
      const portrait = Device && Device.isPortrait && Device.isPortrait();
      const shouldBlock = !!portrait;
      // Avoid spam logs.
      if (this._lastState === shouldBlock) {
        return;
      }
      this._lastState = shouldBlock;
      if (shouldBlock) {
        this.overlay.style.display = 'flex';
        document.body.classList.add('rotate-blocked');
        L.log('[RotateGate] BLOCK', { reason, portrait: true });
      } else {
        this.overlay.style.display = 'none';
        document.body.classList.remove('rotate-blocked');
        L.log('[RotateGate] UNBLOCK', { reason, portrait: false });
      }
      Bus && Bus.notify && Bus.notify('RotateGate.tick');
    }
  };
  window.Demeza.RotateGate = RotateGate;
})();
================================================================================

[-] This file: static/js/simulator.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  const Bus = window.Demeza.LayoutBus;
  const Simulator = {
    slider: null,
    frame: null,
    display: null,
    init() {
      L.log('[Init] Simulator.init');
      this.slider = document.getElementById('widthSlider');
      this.frame = document.getElementById('device-frame');
      this.display = document.getElementById('pxDisplay');
      const btnMobile = document.getElementById('btnMobile');
      const btnDesktop = document.getElementById('btnDesktop');
      const btnLive = document.getElementById('btnLive');
      const btnExit = document.getElementById('exit-live-btn');
      if (this.slider) {
        this.slider.addEventListener('input', (e) => {
          L.log('[UI] widthSlider input', { value: e.target.value });
          this.setWidth(e.target.value, 'slider:input');
        });
        this.slider.addEventListener('change', (e) => {
          L.log('[UI] widthSlider change', { value: e.target.value });
        });
      } else {
        L.warn('[Simulator] widthSlider missing');
      }
      if (btnMobile) btnMobile.addEventListener('click', () => L.log('[UI] button click', { id: 'btnMobile' }));
      if (btnDesktop) btnDesktop.addEventListener('click', () => L.log('[UI] button click', { id: 'btnDesktop' }));
      if (btnLive) btnLive.addEventListener('click', () => L.log('[UI] button click', { id: 'btnLive' }));
      if (btnExit) btnExit.addEventListener('click', () => L.log('[UI] button click', { id: 'exit-live-btn' }));
      const initial = Number(this.slider?.value || 512);
      this.setWidth(initial, 'init');
    },
    setWidth(width, reason) {
      if (!this.frame) {
        L.warn('[Simulator] device-frame missing');
        return;
      }
      const w = Math.max(320, Math.min(1280, Number(width) || 512));
      this.frame.style.width = w + 'px';
      if (this.display) this.display.innerText = `${w}px`;
      if (this.slider) this.slider.value = String(w);
      L.log('[Simulator] setWidth', { w, reason });
      Bus && Bus.notify && Bus.notify('Simulator.setWidth');
    },
    setMode(mode) {
      L.log('[UI] setMode clicked', { mode });
      const width = (mode === 'mobile') ? 512 : 1024;
      this.setWidth(width, `setMode:${mode}`);
    },
    toggleLive() {
      const before = document.body.classList.contains('view-live');
      document.body.classList.toggle('view-live');
      const after = document.body.classList.contains('view-live');
      L.log('[UI] toggleLiveMode', { before, after });
      Bus && Bus.notify && Bus.notify('Simulator.toggleLive');
    }
  };
  window.Demeza.Simulator = Simulator;
  // Optional globals for your inline HTML onclick handlers.
  window.setMode = (m) => Simulator.setMode(m);
  window.toggleLiveMode = () => Simulator.toggleLive();
})();
================================================================================

[-] This file: static/js/workspace_input.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  const WorkspaceInput = {
    canvas: null,
    isPointerDown: false,
    last: { x: 0, y: 0 },
    init() {
      this.canvas = document.getElementById('workspaceCanvas');
      if (!this.canvas) {
        L.warn('[WorkspaceInput] workspaceCanvas missing');
        return;
      }
      L.log('[Init] WorkspaceInput.init');
      this.canvas.addEventListener('pointerdown', (e) => {
        this.isPointerDown = true;
        this.last = { x: e.clientX, y: e.clientY };
        this.canvas.setPointerCapture?.(e.pointerId);
        L.log('[WorkspaceInput] pointerdown', {
          x: e.clientX, y: e.clientY, button: e.button, pointerType: e.pointerType
        });
      });
      this.canvas.addEventListener('pointermove', (e) => {
        if (!this.isPointerDown) return;
        const dx = e.clientX - this.last.x;
        const dy = e.clientY - this.last.y;
        this.last = { x: e.clientX, y: e.clientY };
        L.log('[WorkspaceInput] pointermove(drag)', { x: e.clientX, y: e.clientY, dx, dy, pointerType: e.pointerType });
      });
      this.canvas.addEventListener('pointerup', (e) => {
        this.isPointerDown = false;
        L.log('[WorkspaceInput] pointerup', {
          x: e.clientX, y: e.clientY, button: e.button, pointerType: e.pointerType
        });
      });
      this.canvas.addEventListener('wheel', (e) => {
        L.log('[WorkspaceInput] wheel', { deltaX: e.deltaX, deltaY: e.deltaY, ctrlKey: e.ctrlKey });
      }, { passive: true });
      this.canvas.addEventListener('keydown', (e) => {
        L.log('[WorkspaceInput] keydown', { key: e.key, code: e.code, ctrl: e.ctrlKey, shift: e.shiftKey, alt: e.altKey });
      });
      this.canvas.addEventListener('focus', () => L.log('[WorkspaceInput] focus'));
      this.canvas.addEventListener('blur', () => L.log('[WorkspaceInput] blur'));
    }
  };
  window.Demeza.WorkspaceInput = WorkspaceInput;
})();
================================================================================

[-] This file: static/js/workspace_system.js | Contents:
(function () {
  'use strict';
  window.Demeza = window.Demeza || {};
  const L = window.Demeza.Log;
  const Bus = window.Demeza.LayoutBus;
  const WorkspaceSystem = {
    frame: null,
    header: null,
    grid: null,
    tile: null,
    canvas: null,
    _raf: null,
    init() {
      L.log('[Init] WorkspaceSystem.init');
      this.frame = document.getElementById('device-frame');
      this.header = document.getElementById('headerGroup');
      this.grid = document.getElementById('mainGrid');
      this.tile = document.getElementById('workspaceTile');
      this.canvas = document.getElementById('workspaceCanvas');
      if (!this.frame || !this.header || !this.grid || !this.tile || !this.canvas) {
        L.warn('[Workspace] init missing elements', {
          frame: !!this.frame, header: !!this.header, grid: !!this.grid, tile: !!this.tile, canvas: !!this.canvas
        });
        return;
      }
      // Mark workspace mode for CSS overrides.
      this.frame.classList.add('has-workspace');
      L.log('[Workspace] has-workspace enabled');
      // React to layout signals.
      Bus && Bus.on && Bus.on((reason) => this.fitSoon(reason));
      // React to actual window changes.
      window.addEventListener('resize', () => {
        L.log('[Workspace] window resize');
        this.fitSoon('window.resize');
      });
      window.addEventListener('orientationchange', () => {
        L.log('[Workspace] orientationchange');
        this.fitSoon('window.orientationchange');
      });
      this.fitSoon('init');
    },
    fitSoon(reason) {
      if (this._raf) cancelAnimationFrame(this._raf);
      this._raf = requestAnimationFrame(() => {
        this._raf = null;
        this.fit(reason || 'fitSoon');
      });
    },
    fit(reason) {
      if (!this.frame || !this.header || !this.grid || !this.tile || !this.canvas) {
        L.warn('[Workspace] fit skipped (missing elements)');
        return;
      }
      const isLive = document.body.classList.contains('view-live');
      // 1) Frame height.
      if (!isLive) {
        const gutter = 16;
        const top = this.frame.getBoundingClientRect().top;
        const desired = Math.max(320, Math.round(window.innerHeight - top - gutter));
        this.frame.style.height = desired + 'px';
      } else {
        this.frame.style.height = '100vh';
      }
      // 2) Integer math only.
      const frameClientH = this.frame.clientHeight;
      const headerH = this.header.offsetHeight;
      const gridStyle = window.getComputedStyle(this.grid);
      const padTop = L.numPx(gridStyle.paddingTop);
      const padBot = L.numPx(gridStyle.paddingBottom);
      // 3) Fudge prevents 1px scroll pop.
      const fudge = 1;
      const raw = frameClientH - headerH - padTop - padBot - fudge;
      const workspaceH = Math.max(200, raw);
      this.tile.style.height = workspaceH + 'px';
      this.canvas.style.height = '100%';
      // 4) Micro-scroll kill.
      if (this.frame.scrollTop !== 0) {
        L.log('[Workspace] frame scrollTop reset', { before: this.frame.scrollTop });
        this.frame.scrollTop = 0;
      }
      const overflowFrame = this.frame.scrollHeight - this.frame.clientHeight;
      const overflowGrid = this.grid.scrollHeight - this.grid.clientHeight;
      L.log('[Workspace] fit', {
        reason,
        isLive,
        frameClientH,
        headerH,
        padTop,
        padBot,
        fudge,
        workspaceH,
        overflowFrame,
        overflowGrid
      });
    }
  };
  window.Demeza.WorkspaceSystem = WorkspaceSystem;
})();
================================================================================

[-] This file: templates/classic.html | Contents:
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demeza AutoCSS | Classic Template</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Optional (Device.js will use if present) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/1.0.35/ua-parser.min.js"></script>
  <!-- Shared CSS -->
  <link rel="stylesheet" href="/static/css/demeza_base.css" />
  <link rel="stylesheet" href="/static/css/classic.css" />
</head>
<body>
  <button id="exit-live-btn" onclick="toggleLiveMode()">EXIT LIVE VIEW</button>
  <div class="simulator-wrapper">
    <div class="controls">
      <span style="color:white; font-size:12px; font-weight:512;">DEVICE WIDTH:</span>
      <input
        type="range"
        id="widthSlider"
        min="320"
        max="1280"
        value="400"
        style="width:200px !important;"
      />
      <span id="pxDisplay" style="color:white; font-family:monospace; font-size:12px;">400px</span>
      <button id="btnMobile" onclick="setMode('mobile')" style="padding:5px 15px;">MOBILE</button>
      <button id="btnDesktop" onclick="setMode('desktop')" style="padding:5px 15px;">DESKTOP</button>
      <button
        id="btnLive"
        onclick="toggleLiveMode()"
        style="background: var(--text-main); margin-left:auto; padding:5px 15px;"
      >
        LIVE VIEW
      </button>
    </div>
    <div id="device-frame">
      <div class="header-group" id="headerGroup">
        <div class="meta-bar">
          <div class="meta-left"><a id="metaCredits" href="#">100 Credits</a></div>
          <div class="meta-right"><a id="metaLogin" href="#">Login</a></div>
        </div>
        <nav class="nav-bar" id="mainNav">
          <div class="nav-links" id="navLinks">
            <div class="mobile-meta-group">
              <a class="is-credits" id="mobileCredits" href="#">100 Credits</a>
              <a id="mobileLogin" href="#">Login</a>
            </div>
            <a class="nav-link active" data-nav="Home" href="#">Home</a>
            <a class="nav-link" data-nav="About" href="#">About</a>
            <a class="nav-link" data-nav="Blog" href="#">Blog</a>
            <a class="nav-link" data-nav="Contact" href="#">Contact</a>
          </div>
          <button
            class="hamburger-btn"
            id="hamburgerBtn"
            aria-label="Toggle menu"
            aria-expanded="false"
            aria-controls="navLinks"
          >
            <span class="hamburger-icon"></span>
          </button>
        </nav>
      </div>
      <div class="tile-grid" id="mainGrid">
        <div class="tile tile-stretch">
          <div style="height:100%; display:flex; align-items:center;">
            <h1 style="margin:0; color: var(--text-main); font-weight:768; letter-spacing:-2px;">LOGO</h1>
          </div>
        </div>
        <div class="tile tile-ghost"></div>
        <div class="tile tile-std">
          <h3>Join Mailing List</h3>
          <input id="mailInput" type="text" placeholder="Enter your email">
          <button id="refButton" class="btn-ref">SUBMIT</button>
        </div>
        <div class="tile tile-ghost"></div>
        <div class="tile tile-std">
          <h3>Settings Smooth</h3>
          <div class="slider-wrapper">
            <span class="slider-label">0</span>
            <div class="range-container">
              <input type="range" id="advSlider" min="0" max="100" value="50">
              <div class="slider-value" id="sliderValue">50</div>
            </div>
            <span class="slider-label">100</span>
          </div>
        </div>
        <div class="tile tile-std">
          <h3>Upload File</h3>
          <label id="matchLabel" class="file-upload-label btn-match">
            CHOOSE FILE
            <input type="file" id="fileInput" style="display:none;">
          </label>
          <span id="fileName" class="file-name-display">...</span>
        </div>
        <div class="tile tile-std">
          <h3>Settings Snap</h3>
          <img
            id="snapImage"
            src="https://placehold.co/64x64/2EC4B6/ffffff?text=0"
            style="width:64px; height:64px; border-radius:0; object-fit:cover;"
            alt="Snap preview"
          >
          <div class="slider-wrapper">
            <span class="slider-label">0</span>
            <div class="range-container">
              <input type="range" id="snapSlider" min="0" max="2" step="1" value="0">
              <div class="slider-value">0</div>
            </div>
            <span class="slider-label">2</span>
          </div>
        </div>
        <div class="tile tile-stretch">
          <h3>Paste text here</h3>
          <textarea id="pasteArea"></textarea>
        </div>
        <div class="tile tile-std" id="step1">
          <h3>Your file is ready!</h3>
        </div>
        <div class="tile tile-std" id="step2">
          <button id="viewButton" class="btn-ref">View File</button>
        </div>
        <div class="tile tile-std" id="step3">
          <button id="againButton" class="btn-ref">Generate Another</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Shared JS -->
  <script src="/static/js/log.js"></script>
  <script src="/static/js/layout_bus.js"></script>
  <script src="/static/js/device.js"></script>
  <script src="/static/js/nav_ui.js"></script>
  <script src="/static/js/simulator.js"></script>
  <!-- Classic-only JS (kept inline for now) -->
  <script>
    (function () {
      const D = window.Demeza || {};
      const L = D.Log || console;
      function preventNavDefaultClicks() {
        const ids = ['metaCredits','metaLogin','mobileCredits','mobileLogin'];
        ids.forEach((id) => {
          const el = document.getElementById(id);
          if (!el) return;
          el.addEventListener('click', (e) => {
            e.preventDefault();
            L.log('[UI] prevent default (meta link)', { id });
          });
        });
        document.querySelectorAll('.nav-link').forEach((a) => {
          a.addEventListener('click', (e) => {
            e.preventDefault();
            L.log('[UI] prevent default (nav link)', { label: a.getAttribute('data-nav') || a.textContent });
          });
        });
      }
      const ClassicUI = {
        initSliders() {
          L.log('[Init] ClassicUI.initSliders');
          document.querySelectorAll('.range-container').forEach((container) => {
            const slider = container.querySelector('input[type="range"]');
            const bubble = container.querySelector('.slider-value');
            if (!slider || !bubble) return;
            const updateBubble = (val) => {
              const min = parseFloat(slider.min) || 0;
              const max = parseFloat(slider.max) || 100;
              const percent = ((val - min) * 100) / (max - min);
              const offset = 8 - (percent * 0.15);
              bubble.textContent = String(val);
              bubble.style.left = `calc(${percent}% + ${offset}px)`;
            };
            updateBubble(slider.value);
            slider.addEventListener('input', (e) => {
              updateBubble(e.target.value);
              bubble.classList.add('active');
              L.log('[UI] slider input', { id: slider.id, value: e.target.value });
            });
            const hideBubble = () => bubble.classList.remove('active');
            ['change', 'mouseup', 'touchend'].forEach((evt) => slider.addEventListener(evt, hideBubble));
          });
        },
        initSnapSlider() {
          L.log('[Init] ClassicUI.initSnapSlider');
          const snapSlider = document.getElementById('snapSlider');
          const snapImage = document.getElementById('snapImage');
          const images = {
            '0': 'https://placehold.co/64x64/2EC4B6/ffffff?text=0',
            '1': 'https://placehold.co/64x64/FF9F1C/ffffff?text=1',
            '2': 'https://placehold.co/64x64/333333/ffffff?text=2'
          };
          if (!snapSlider || !snapImage) {
            L.warn('[ClassicUI] snapSlider or snapImage missing');
            return;
          }
          snapSlider.addEventListener('input', (e) => {
            const val = e.target.value;
            if (images[val]) snapImage.src = images[val];
            L.log('[UI] snapSlider input', { value: val });
          });
        },
        bindButtonsAndFile() {
          const refButton = document.getElementById('refButton');
          const viewButton = document.getElementById('viewButton');
          const againButton = document.getElementById('againButton');
          const fileInput = document.getElementById('fileInput');
          const fileName = document.getElementById('fileName');
          const mailInput = document.getElementById('mailInput');
          if (refButton) refButton.addEventListener('click', () => {
            L.log('[UI] submit mailing list', { email: (mailInput?.value || '').trim() });
          });
          if (viewButton) viewButton.addEventListener('click', () => L.log('[UI] view file'));
          if (againButton) againButton.addEventListener('click', () => L.log('[UI] generate another'));
          if (fileInput) {
            fileInput.addEventListener('change', () => {
              const name = fileInput.files && fileInput.files[0] ? fileInput.files[0].name : '...';
              if (fileName) fileName.textContent = name;
              L.log('[UI] file chosen', { name });
            });
          }
        }
      };
      const ClassicLayout = {
        syncButtonStyles() {
          const ref = document.getElementById('refButton');
          const target = document.getElementById('matchLabel');
          if (!ref || !target) return;
          const computed = window.getComputedStyle(ref);
          ['fontSize','fontFamily','fontWeight','lineHeight','height']
            .forEach((prop) => target.style[prop] = computed[prop]);
          L.log('[Layout] syncButtonStyles', { ok: true });
        },
        optimizeTextarea() {
          const txtArea = document.getElementById('pasteArea');
          if (!txtArea) return;
          const tile = txtArea.closest('.tile');
          const header = tile ? tile.querySelector('h3') : null;
          if (!tile) return;
          tile.style.display = 'flex';
          tile.style.flexDirection = 'column';
          tile.style.alignItems = 'flex-start';
          tile.style.textAlign = 'left';
          txtArea.style.flexGrow = '1';
          txtArea.style.width = '100%';
          if (header) {
            header.style.marginBottom = 'var(--q-16)';
            header.style.width = '100%';
          }
          L.log('[Layout] optimizeTextarea', { ok: true });
        },
        refresh(reason) {
          L.log('[Layout] refresh', { reason });
          this.syncButtonStyles();
          this.optimizeTextarea();
        }
      };
      const ArrowSystem = {
        grid: null,
        arrows: [],
        nudge: 12,
        arrowSVG: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 21l-10-16h20l-10 16z"/></svg>`,
        init() {
          this.grid = document.getElementById('mainGrid');
          if (!this.grid) {
            L.warn('[ArrowSystem] mainGrid missing');
            return;
          }
          this.arrows.forEach((a) => a.element.remove());
          this.arrows = [];
          const connections = [
            { from: 'step1', to: 'step2' },
            { from: 'step2', to: 'step3' }
          ];
          connections.forEach((conn) => {
            const elFrom = document.getElementById(conn.from);
            const elTo = document.getElementById(conn.to);
            if (!elFrom || !elTo) {
              L.warn('[ArrowSystem] missing tiles', { from: conn.from, to: conn.to });
              return;
            }
            const arrowEl = document.createElement('div');
            arrowEl.className = 'floating-arrow';
            arrowEl.innerHTML = this.arrowSVG;
            this.grid.appendChild(arrowEl);
            this.arrows.push({ element: arrowEl, from: elFrom, to: elTo });
            L.log('[ArrowSystem] connection added', conn);
          });
          const ro = new ResizeObserver(() => this.update('ResizeObserver'));
          ro.observe(this.grid);
          setTimeout(() => this.update('init:timeout'), 100);
          this.update('init:immediate');
        },
        update(reason) {
          if (!this.grid) return;
          const gridRect = this.grid.getBoundingClientRect();
          this.arrows.forEach((arrow) => {
            const r1 = arrow.from.getBoundingClientRect();
            const r2 = arrow.to.getBoundingClientRect();
            const c1 = { x: r1.left + r1.width / 2, y: r1.top + r1.height / 2 };
            const isVertical = (r2.top > (r1.bottom - 10));
            let x, y, rotation;
            if (isVertical) {
              x = c1.x;
              y = r1.bottom + this.nudge;
              rotation = 0;
            } else {
              x = r1.right + this.nudge;
              y = c1.y;
              rotation = -90;
            }
            const finalLeft = x - gridRect.left;
            const finalTop = y - gridRect.top;
            arrow.element.style.left = `${finalLeft - 24}px`;
            arrow.element.style.top = `${finalTop - 24}px`;
            arrow.element.style.transform = `rotate(${rotation}deg)`;
          });
          L.log('[ArrowSystem] update', { reason, count: this.arrows.length });
        }
      };
      window.addEventListener('load', () => {
        L.log('[Boot] classic.html load');
        D.NavUI && D.NavUI.init && D.NavUI.init();
        D.Simulator && D.Simulator.init && D.Simulator.init();
        preventNavDefaultClicks();
        ClassicUI.initSliders();
        ClassicUI.initSnapSlider();
        ClassicUI.bindButtonsAndFile();
        ClassicLayout.refresh('load');
        ArrowSystem.init();
        const isMobile = D.Device && D.Device.isNativeMobile && D.Device.isNativeMobile();
        if (isMobile) {
          document.body.classList.add('is-native-mobile');
          L.log('[Device] native mobile detected -> auto live', { isMobile: true });
          // Start live view on real mobile (like before)
          window.toggleLiveMode && window.toggleLiveMode();
        }
      });
      window.addEventListener('resize', () => {
        ClassicLayout.refresh('window.resize');
        ArrowSystem.update('window.resize');
      });
    })();
  </script>
</body>
</html>
================================================================================

[-] This file: templates/game.html | Contents:
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>deMeza AutoCSS | Game Template</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/1.0.35/ua-parser.min.js"></script>
  <link rel="stylesheet" href="/static/css/demeza_base.css">
  <link rel="stylesheet" href="/static/css/demeza_workspace.css">
</head>
<body>
  <button id="exit-live-btn" onclick="toggleLiveMode()">EXIT LIVE VIEW</button>
  <div class="simulator-wrapper">
    <div class="controls">
      <span style="color:white; font-size:12px; font-weight:512;">DEVICE WIDTH:</span>
      <input type="range" id="widthSlider" min="320" max="1280" value="512" style="width:200px !important;">
      <span id="pxDisplay" style="color:white; font-family:monospace; font-size:12px;">512px</span>
      <button id="btnMobile" onclick="setMode('mobile')" style="padding:5px 15px;">MOBILE</button>
      <button id="btnDesktop" onclick="setMode('desktop')" style="padding:5px 15px;">DESKTOP</button>
      <button
        id="btnLive"
        onclick="toggleLiveMode()"
        style="background: var(--text-main); margin-left: auto; padding: 5px 15px;"
      >
        LIVE VIEW
      </button>
    </div>
    <div id="device-frame">
      <div class="header-group" id="headerGroup">
        <div class="meta-bar">
          <div class="meta-left"><a id="metaCredits">100 Credits</a></div>
          <div class="meta-right"><a id="metaLogin">Login</a></div>
        </div>
        <nav class="nav-bar" id="mainNav">
          <div class="nav-links" id="navLinks">
            <div class="mobile-meta-group">
              <a class="is-credits" id="mobileCredits">100 Credits</a>
              <a id="mobileLogin">Login</a>
            </div>
            <a class="nav-link active" data-nav="Game">Game</a>
            <a class="nav-link" data-nav="About">About</a>
            <a class="nav-link" data-nav="Blog">Blog</a>
            <a class="nav-link" data-nav="Contact">Contact</a>
          </div>
          <button
            class="hamburger-btn"
            id="hamburgerBtn"
            aria-label="Toggle menu"
            aria-expanded="false"
            aria-controls="navLinks"
          >
            <span class="hamburger-icon"></span>
          </button>
        </nav>
      </div>
      <div class="tile-grid" id="mainGrid">
        <div class="tile tile-workspace" id="workspaceTile">
          <div id="workspaceCanvas" tabindex="0">
            <div class="workspace-hint">Game Canvas (rotate on mobile)</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="/static/js/log.js"></script>
  <script src="/static/js/layout_bus.js"></script>
  <script src="/static/js/device.js"></script>
  <script src="/static/js/nav_ui.js"></script>
  <script src="/static/js/simulator.js"></script>
  <script src="/static/js/workspace_input.js"></script>
  <script src="/static/js/workspace_system.js"></script>
  <script src="/static/js/rotate_gate.js"></script>
  <script src="/static/js/game_boot.js"></script>
  <script>
    (function () {
      'use strict';
      window.addEventListener('load', () => {
        const D = window.Demeza || {};
        const L = D.Log;
        try {
          const isMobile = D.Device && D.Device.isNativeMobile && D.Device.isNativeMobile();
          L && L.log && L.log('[Game] mobile auto-live check', { isMobile });
          if (isMobile) {
            document.body.classList.add('is-native-mobile');
            if (!document.body.classList.contains('view-live')) {
              D.Simulator && D.Simulator.toggleLive && D.Simulator.toggleLive();
            }
          }
        } catch (e) {
          L && L.warn && L.warn('[Game] mobile auto-live failed', { e: String(e) });
        }
      });
    })();
  </script>
</body>
</html>
================================================================================

[-] This file: templates/index.html | Contents:
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>deMeza AutoCSS | Never design a separate mobile and desktop version again | Home</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-color: #f4f4f9;
      --tile-bg: #ffffff;
      --accent: #FF9F1C;
      --text-main: #2EC4B6;
      --text-dark: #333;
      --nav-dark: #222;
      --border-light: #ebeff5;
      --border-med: #a3adbf;
      --q-4: 4px;
      --q-8: 8px;
      --q-16: 16px;
      --q-24: 24px;
      --q-32: 32px;
      --q-48: 48px;
      --gap: var(--q-16);
      --padding: var(--q-16);
      --radius: 0px;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Nunito', sans-serif; }
    body{
      background-color:#1a1a1a;
      color:#eee;
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: var(--q-24);
    }
    .wrap{
      width: min(980px, 100%);
      display:flex;
      flex-direction:column;
      gap: var(--q-16);
    }
    .titlebar{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap: var(--q-16);
      padding: var(--q-16);
      border: 4px solid #111;
      background: #2b2b2b;
    }
    .brand{
      font-weight: 800;
      letter-spacing: -1px;
      color: var(--text-main);
      font-size: 28px;
      line-height: 1.1;
    }
    .subtitle{
      font-family: monospace;
      font-size: 12px;
      color: #cfcfcf;
      opacity: 0.85;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: var(--gap);
    }
    @media (min-width: 760px){
      .grid{ grid-template-columns: repeat(3, 1fr); }
    }
    .card{
      background: var(--tile-bg);
      color: var(--text-dark);
      border: 4px solid var(--accent);
      border-radius: var(--radius);
      padding: var(--q-24);
      cursor: pointer;
      user-select: none;
      transition: transform 0.12s ease;
      display:flex;
      flex-direction:column;
      gap: var(--q-16);
      min-height: 220px;
      justify-content:space-between;
      box-shadow: 0 6px 18px rgba(0,0,0,0.28);
      outline: none;
    }
    .card:hover{ transform: translateY(-2px); }
    .card:active{ transform: translateY(1px); }
    .card h2{
      margin: 0;
      font-size: 22px;
      letter-spacing: -0.5px;
      color: var(--text-main);
    }
    .card p{
      margin: 0;
      font-size: 14px;
      line-height: 1.45;
      opacity: 0.9;
    }
    .badge-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: var(--q-16);
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap: var(--q-8);
      padding: 6px 10px;
      border: 2px solid rgba(0,0,0,0.12);
      background: rgba(255,255,255,0.92);
      font-family: monospace;
      font-size: 12px;
      color: #111;
      border-radius: var(--radius);
    }
    .arrow{
      font-family: monospace;
      font-weight: 900;
      color: var(--accent);
    }
    .footer{
      font-family: monospace;
      font-size: 12px;
      opacity: 0.65;
      padding: 0 var(--q-4);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="titlebar">
      <div>
        <div class="brand">deMeza AutoCSS</div>
        <div class="subtitle">Choose a common template</div>
      </div>
    </div>
    <div class="grid" aria-label="Mode selection">
      <div
        class="card"
        role="button"
        tabindex="0"
        data-home-card="1"
        data-target="/classic"
        aria-label="Open Classic">
        <div>
          <h2>Classic</h2>
          <p>
            The original AutoCSS tile layout with standard tiles and simulator controls.
          </p>
        </div>
        <div class="badge-row">
          <span class="badge">Route: /classic</span>
          <span class="arrow">→</span>
        </div>
      </div>
      <div
        class="card"
        role="button"
        tabindex="0"
        data-home-card="1"
        data-target="/workspace"
        aria-label="Open Workspace">
        <div>
          <h2>Workspace</h2>
          <p>
            Full-width workspace tile that dominates the layout, ready for nodes and canvas UI.
          </p>
        </div>
        <div class="badge-row">
          <span class="badge">Route: /workspace</span>
          <span class="arrow">→</span>
        </div>
      </div>
      <!-- UNLOCKED: no "TBA" styling -->
      <div
        class="card"
        role="button"
        tabindex="0"
        data-home-card="1"
        data-target="/game"
        aria-label="Open Game">
        <div>
          <h2>Game</h2>
          <p>
            Game layout (based on Workspace). On mobile, shows “Rotate to play” overlay.
          </p>
        </div>
        <div class="badge-row">
          <span class="badge">Route: /game</span>
          <span class="arrow">→</span>
        </div>
      </div>
    </div>
    <div class="footer">
      <span>deMeza AutoCSS </span><span id="footerYear">2025</span>
    </div>
  </div>
  <!-- JS -->
  <script src="/static/js/log.js"></script>
  <script src="/static/js/layout_bus.js"></script>
  <script src="/static/js/device.js"></script>
  <script src="/static/js/index.js"></script>
  <script src="/static/js/index_boot.js"></script>
  <script>
    // Footer year (auto-updates)
    (function(){
      const y = new Date().getFullYear();
      const el = document.getElementById('footerYear');
      if (el) el.textContent = String(y);
    })();
    // Keyboard support for the cards, with logging.
    (function(){
      const L = window.Demeza && window.Demeza.Log ? window.Demeza.Log : null;
      const log = L ? L.log : console.log;
      document.querySelectorAll('[data-home-card]').forEach((card) => {
        card.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const target = card.getAttribute('data-target') || '';
            log('[UI] home card key activate', { key: e.key, target });
            if (target) window.location.href = target;
          } else {
            log('[UI] home card keydown', { key: e.key });
          }
        });
      });
      log('[Init] index.html inline keybinds ready');
    })();
  </script>
</body>
</html>
================================================================================

[-] This file: templates/workspace.html | Contents:
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demeza AutoCSS | Workspace Template</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- UAParser optional, Device.js will use it if present -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/1.0.35/ua-parser.min.js"></script>
  <!-- Shared CSS -->
  <link rel="stylesheet" href="/static/css/demeza_base.css">
  <!-- Workspace-specific CSS -->
  <link rel="stylesheet" href="/static/css/demeza_workspace.css">
</head>
<body>
  <button id="exit-live-btn" onclick="toggleLiveMode()">EXIT LIVE VIEW</button>
  <div class="simulator-wrapper">
    <div class="controls">
      <span style="color:white; font-size:12px; font-weight:512;">DEVICE WIDTH:</span>
      <input type="range" id="widthSlider" min="320" max="1280" value="512" style="width:200px !important;">
      <span id="pxDisplay" style="color:white; font-family:monospace; font-size:12px;">512px</span>
      <button id="btnMobile" onclick="setMode('mobile')" style="padding:5px 15px;">MOBILE</button>
      <button id="btnDesktop" onclick="setMode('desktop')" style="padding:5px 15px;">DESKTOP</button>
      <button
        id="btnLive"
        onclick="toggleLiveMode()"
        style="background: var(--text-main); margin-left: auto; padding: 5px 15px;"
      >
        LIVE VIEW
      </button>
    </div>
    <div id="device-frame">
      <div class="header-group" id="headerGroup">
        <div class="meta-bar">
          <div class="meta-left"><a id="metaCredits">100 Credits</a></div>
          <div class="meta-right"><a id="metaLogin">Login</a></div>
        </div>
        <nav class="nav-bar" id="mainNav">
          <div class="nav-links" id="navLinks">
            <div class="mobile-meta-group">
              <a class="is-credits" id="mobileCredits">100 Credits</a>
              <a id="mobileLogin">Login</a>
            </div>
            <a class="nav-link active" data-nav="Workspace">Workspace</a>
            <a class="nav-link" data-nav="About">About</a>
            <a class="nav-link" data-nav="Blog">Blog</a>
            <a class="nav-link" data-nav="Contact">Contact</a>
          </div>
          <button
            class="hamburger-btn"
            id="hamburgerBtn"
            aria-label="Toggle menu"
            aria-expanded="false"
            aria-controls="navLinks"
          >
            <span class="hamburger-icon"></span>
          </button>
        </nav>
      </div>
      <div class="tile-grid" id="mainGrid">
        <!-- WORKSPACE TILE (dominant) -->
        <div class="tile tile-workspace" id="workspaceTile">
          <div id="workspaceCanvas" tabindex="0">
            <div class="workspace-hint">Workspace Canvas (nodes go here)</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Shared JS -->
  <script src="/static/js/log.js"></script>
  <script src="/static/js/layout_bus.js"></script>
  <script src="/static/js/device.js"></script>
  <script src="/static/js/nav_ui.js"></script>
  <script src="/static/js/simulator.js"></script>
  <!-- Workspace JS -->
  <script src="/static/js/workspace_input.js"></script>
  <script src="/static/js/workspace_system.js"></script>
  <!-- Boot -->
  <script>
    (function () {
      'use strict';
      window.addEventListener('load', () => {
        const D = window.Demeza || {};
        const L = D.Log;
        L && L.log && L.log('[Boot] workspace_boot');
        D.NavUI && D.NavUI.init && D.NavUI.init();
        D.Simulator && D.Simulator.init && D.Simulator.init();
        D.WorkspaceInput && D.WorkspaceInput.init && D.WorkspaceInput.init();
        D.WorkspaceSystem && D.WorkspaceSystem.init && D.WorkspaceSystem.init();
        // Optional: auto-live on real mobile devices (no exit button on mobile by design)
        try {
          const isMobile = D.Device && D.Device.isNativeMobile && D.Device.isNativeMobile();
          L && L.log && L.log('[Workspace] mobile auto-live check', { isMobile });
          if (isMobile) {
            document.body.classList.add('is-native-mobile');
            if (!document.body.classList.contains('view-live')) {
              D.Simulator && D.Simulator.toggleLive && D.Simulator.toggleLive();
            }
          }
        } catch (e) {
          L && L.warn && L.warn('[Workspace] mobile auto-live failed', { e: String(e) });
        }
      });
    })();
  </script>
</body>
</html>
================================================================================
